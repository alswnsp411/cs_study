# OSI 7계층  

OSI7계층(Open Systems Interconnection 7 Laye) 은 네트워크에서 통신이 일어나는 과정을 7단계로 모듈화 한 것이다.  
7개의 계층으로 나누어 기능별로 분리해서 통신이 일어나는 과정을 단계별로 파악할 수 있다.  
또한, 각 계층은 독립적으로 작용하며 각 계층마다 프로토콜이라는 데이터를 주고받기 위한 일종의 약속이 존재한다.  
따라서 7단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건드리지 않고도 이상이 생긴 단계만 고칠 수 있다.  

TCP/IP 4계층은 OSI 참조 모델을 기반으로 상업적이고 실무적으로 이용될 수 있도록 단순화된 모형이다.

<br />

![osi 7layer](https://github.com/kksshh0612/cs_study/assets/74577811/7717be92-efbf-403e-b0a0-50e2bc691619)

<br />

**계층간 상하 구조를 가지기 때문에 상위 계층의 프로토콜이 제대로 동작하기 위해서는 하위의 모든 계층에 문제가 없어야 한다.**

<br />

> ### ✨ 예제를 통한 TCP/IP 흐름 이해  

 ![데이터 전송 과정](https://github.com/kksshh0612/cs_study/assets/74577811/7eeca275-9c59-4459-b62d-0962491aba50)  

  **송신 호스트**의 각 계층에서는 맡은 역할에 따라 프로토콜을 처리하고, 상위 계층으로부터 받은 데이터에 헤더를 붙여 하위 계층으로 넘긴다.(캡슐화)
 - 송신 호스트에서 www.google.com을 웹브라우저에 입력한다. : 구글 웹서버에 80번 포트로 HTTP Request를 보낸다는 의미와 동일하다.
 - 응용 계층 (5, 6, 7 계층) : 응용 프로그램과 관련된 헤더(HTTP Request)가 추가되며 응용 프로그램과 관련된 일들을 수행한다.
 - 전송 계층 : 어떤 식의 통신을 할 지 결정하는 일을 수행한다. 목적지 포트 번호 80을 포함한 TCP/UDP 헤더를 추가한다.  
 - 네트워크 계층 : 목적지 호스트로 도달하기 위한 경로 설정을 한다. IP 헤더를 추가한다. 이때 목적지 IP주소를 알아내기 위해 도메인 서버에 www.google.com에 대한 DNS 쿼리를 보내 IP 주소를 응답받는다.
 - 데이터 링크 계층 :  신뢰성있는 데이터 전송을 위한 오류제어, 흐름 제어를 수행한다. MAC 주소를 포함하는 이더넷 헤더를 추가한다. 이 때 목적지 MAC 주소를 알아내기 위해 ARP 프로토콜을 사용한다.
 - 물리 계층 : bit 형식의 데이터를 아날로그 신호로 변환하여 물리적인 매체(유선 또는 무선)를 통해 전송한다.
<br />

 **패킷은 데이터 링크 계층의 MAC 주소와 네트워크 계층의 IP 주소로 라우팅을 반복해 수신 호스트에 도착한다.**
 
<br/>

 - **수신 호스트**의 각 계층에서는 하위 계층으로부터 받은 데이터에 포함된 헤더 부분의 정보를 사용해서 해당 계층의 프로토콜을 처리한 후 헤더 부분을 제거한 데이터를 상위 계층으로 넘긴다.
 - 전송 계층 : 헤더의 목적지의 포트 번호 (80포트)를 사용하고 있는 응용 계층에 데이터를 전송한다.
 - 응용 계층(5, 6, 7 계층) : HTTP Request 데이터를 받아 "/"에 매핑된 GET 요청을 처리한다.
 - 적절한 HTML을 클라이언트에게 응답한다.
 - 송신 호스트는 라우팅을 통해 전달받은 "www.google.com"에 해당하는 HTML을 브라우저에 띄우게 된다.

<br/>
<br/>

### 1 계층 : 물리 계층(Physical Layer)

전선을 통해 물리적으로 연결된 노드간에 0과 1의 비트들의 나열(데이터)을 주고 받을 수 있게 해주는 모듈이다.  
디지털 데이터를 아날로그적인 **전기적 신호로 변환**하여 **전선을 통한 물리적인 전송**이 가능하게 한다.  
단지 데이터 전달의 역할을 수행 할 뿐 그것이 어떤 내용인지는 고려하지 않는다.
- 데이터 단위(PDU) : 비트(bit)
- 관련 장비 : 허브(hub), 리피터(Repeater)

> - (더미)허브
>  : 허브에 연결된 케이블 중 한 케이블로 신호가 들어오면 같은 신호를 다른 모든 케이블로 전달한다. 신호를 받은 랜카드는 자신에게 온 신호가 아니면 무시한다.

> - 리피터
>  : 일그러진 전기 신호를 복원하고 증폭하는 기능을 수행한다.

<br/>
<br/>

### 2 계층 : 데이터 링크 계층(DataLink Layer)

물리적인 연결(유선 또는 무선)을 통해 **직접 연결된** 두 장치간의 **신뢰성 있는** 데이터 전송을 담당한다. 
이웃 장치를 넘어서는 통신 문제는 고려하지 않는다.  
네트워크 카드의 **MAC주소**를 통해 목적지를 찾아간다.  
신뢰성 있는 데이터 전송을 위해 흐름제어, 오류제어, 접근제어, 회선제어를 수행한다.  

- 관련 프로토콜 : ARP, HDLC, PPP, LLC 등
- 데이터 단위 : Frame = 이더넷 헤더(출발지, 목적지 MAC 주소 포함)+data+트레일러(오류 검출을 위한 CRC)
- 관련 장비 : L2 switch, bridge, 네트워크 카드(NIC)

> - L2 switch
>   : MAC 주소 테이블을 통해 옆 노드간의 통신을 수행한다.
>   스위치를 통해 각 장치를 연결함으로써 이더넷을 통한 '하나의 네트워크'를 구성할 수 있다.

> - bridge
>   : 두 개의 LAN을 연결한다.

> - 네트워크 카드(NIC, 이더넷 카드, 네트워크 어댑터, 랜카드)
>   : 컴퓨터의 구성품 중 하나로 한 네트워크 안에서 컴퓨터간 신호를 주고받는 데 쓰이는 하드웨어이다. MAC 주소를 근거로 데이터를 처리 혹은 폐기한다.

<br/>
<br/>

### 3 계층 : 네트워크 계층 (Network Layer)

**IP주소**를 통해 목적지 호스트로 데이터를 전송한다.  
목적지 호스트로 도달하기 위한 최적의 경로를 **라우팅 알고리즘**을 통해 선택하고 제어한다.
노드간 전송을 어떻게 할 것인가는 3계층의 관심사가 아니다.

- 관련 프로토콜 : IP, ICMP
- 데이터 단위: Packet = IP 헤더(출발지, 목적지 IP 주소 포함) + data
- 관련 장비 : Router, L3 switch

> - Router(라우터)
>   : 여러 네트워크를 연결하고 네트워크 간에 데이터 패킷을 전달하는 장치
>     라우팅 테이블을 참조해 목적지 IP주소를 기반으로 적절한 통신이 이뤄질 수 있도록 최적의 경로를 탐색, 결정한다.

> - L3 switch
>  : MAC주소 기반으로만 트래픽을 전달하는 기존 스위치와 달리 L3 스위치는 로컬 네트워크 간에 IP 주소를 기반으로  트래픽을 라우팅할 수 있다.

<br/>
<br/>

### 4 계층 : 전송 계층 (Transport Layer)

통신 양단에 있는 최종 사용자 사이의 연결을 제공하여 목적지 호스트까지 **신뢰할 수 있는 데이터**가 도달할 수 있도록 한다.  
**어떤 식의 통신(TCP 혹은 UDP)**을 할 것인가 결정하는 계층. 실제로 보내려는 데이터가 어떻게 목적지까지 찾아가게 만들것인가는 결정하지 않는다(이것은 네트워크 계층)  
5, 6, 7계층에서 전송 기능의 구현 상세를 알고 있을 필요가 없도록 한다.
데이터가 제대로 도착했는지 확인(수신 확인 기능)하고, 데이터가 최종적으로 도착할 애플리케이션이 무엇인지 식별한다.
프로세스를 특정하기 위한 주소로 **포트 번호**를 이용한다.
신뢰성있는 데이터 전송을 위해 분할, 재조합, 연결제어, 흐름제어, 오류제어, 혼잡제어를 수행한다.

- 관련 프로토콜: TCP(연결형 통신), UDP(비연결형 통신)
- 데이터 단위: segment=(TCP/UDP) 헤더+ data

<br/>
<br/>

** 5, 6, 7 계층은 application과 관련된 기능 제공
  데이터 단위  : data or message

### 5 계층 : 세션 계층(Session Layer)

응용 프로그램간의 논리적인 연결(세션)생성 및 제어를 담당한다.  
통신 중 연결이 끊어지지 않도록 유지시켜주는 역할을 수행하기 위해 TCP/IP 통신 세션을 설정, 유지, 종료 하는 기능, 세션 메세지 전송 및 전송 중단시 복구 등의 기능을 제공한다.
- 관련 프로토콜 : RPC(Remote procedure call)

<br/>

### 6 계층 : 표현 계층(Presentation Layer)

응용 프로그램간 데이터 표현 방식 간의 변화에 대해 규정한다.  
애플리케이션이 다루는 정보를 통신에 알맞은 형태로 만들거나, 하위 계층에서 온 데이터를 사용자가 이해할 수 있는 형태로 만든다.  
인코딩/디코딩, 압축/해제, 암호화/복호화 등의 역할을 수행한다.
- 관련 프로토콜 : JPEG, MPEG
  
<br/>

### 7 계층 : 응용 계층(Application Layer)

애플리케이션 목적에 맞는 통신 방법을 제공한다.
- 관련 프로토콜 : HTTP(웹페이지), FTP(파일 전송), DNS(도메인>IP주소), SMTP(이메일)

대표적으로 HTTP라는 응용계층 프로토콜은 응용 프로그램인 웹 브라우저에게 필요한 데이터를 송수신할때 사용한다. 브라우저는 프로토콜을 보다 쉽게 사용하게 해주는 역할

모든 통신의 양 끝단은 HTTP와 같은 프로토콜이지 응용프로그램이 아님

<br />

---

<br />


### Transport Layer와, Network Layer의 차이에 대해 설명해 주세요.
Transport Layer는 통신 시 **어떤 방식의 통신(TCP/UDP)**을 할 것인지 결정, 두 호스트 간 신뢰성 있는 데이터 전송, 흐름 제어 등의 역할을 한다. 3계층인 Network Layer는 패킷 전송을 위해 라우팅 프로토콜을 기반으로 가장 효율적인 **경로를 선택**해 **전송**하는 역할을 한다.   

Transport Layer는 상위 계층에 정보 전달을 위해 포트 번호를 통해 프로세스를 식별한다. Network Layer는 데이터를 목적지까지 전달하기 위해 IP주소, 라우터를 사용한다. 

Transport Layer의 데이터 단위는 (TCP/UDP) 헤더와 data로 이루어진 세그먼트(segment)이다.  
Network Layer의 데이터 단위는 IP헤더와 data로 이루어진 패킷이다.


<br />

### L3 Switch와 Router의 차이에 대해 설명해 주세요.
L3 switch와 router는 계속 발전하면서 기능이 거의 같아졌지만 개념적으로 차이가 있다.
L3 스위치 : HW 기반, NAT 안됨, WAN 지원하지 않음.
라우터 : SW 기반

L3 스위치: 
- 로컬 네트워크 내에서 트래픽을 라우팅 한다.
- 브로드캐스트 트래픽을 줄여 네트워크 성능 향상. 네트워크를 더 작은 서브넷으로 분할하고 VLAN을 사용하면 브로드캐스트 트래픽이 각 서브넷 내에 포함되어 정체가 줄어들고 전반적인 효율성이 향상된다.

라우터:
- 일반적으로 가정과 기업에서 LAN(Local Area Network)을 서로 연결하거나 인터넷과 같은 **WAN**(Wide Area Network)에 연결하는 데 사용된다. 또한 더 큰 LAN을 더 작은 서브넷으로 분할하여 네트워크 성능과 보안을 향상시키는데 사용할 수 있다.
- **NAT**(Network Adderss Translation)을 통해 LAN에서 사설 IP 주소를 가진 장치가 사설 IP를 단일 공용 IP로 변환하여 공용 인터넷의 장치와 통신할 수 있도록 한다.

<br />

### 각 Layer는 패킷을 어떻게 명칭하나요? 예를 들어, Transport Layer의 경우 Segment라 부릅니다.

> 3계층인 네트워크 계층의 라우팅을 통한 패킷 전송 때문에 보통 네트워크에서 통신이 일어날 때 데이터 단위로 패킷을 많이 사용한다. 하지만 각 계층에서 사용하는 프로토콜 데이터 단위가 다르기 때문에 각 layer에서의 패킷 명칭이 다르다.

![패킷](https://github.com/kksshh0612/cs_study/assets/74577811/2882882d-93cc-4e41-b614-b67fa564e6db)  

1. 물리 계층(Physical Layer) : 비트(bit)
2. 데이터 링크 계층(Data Link Layer) : 프레임 (frame)
3. 네트워크 계층(Network Layer) : 패킷 (Packet)
4. 전송 계층(Transport Layer) : 세그먼트 (Segment)
5. 세션 계층(Session Layer) : 데이터 (Data)
6. 표현 계층 (Presentation Layer) : 데이터 (Data)
7. 응용 계층 (Application Layer) : 메시지 (Message)

   
<br />


### 각각의 Header의 Packing Order에 대해 설명해 주세요.
헤더에는 해당 계층에서 데이터를 처리할 때 필요한 정보가 담겨져 있다.  
-> 송신지나 수신지에 대한 정보(MAC 주소, IP주소, 포트번호), 각 계층의 해당 프로토콜이 필요로 하는 정보 및 처리 내용에 관한 정보  
> packet order : 네트워크 장치간에 데이터 패킷이 송수신되는 순서

![데이터 캡슐화](https://github.com/kksshh0612/cs_study/assets/74577811/3c925fe5-53f6-4fee-9bb7-8a0d0f4fc247)

1. 물리 계층(Physical Layer) : 비트들의 나열이 아날로그 신호 형태로 변환되어 전송된다.
2. 데이터 링크 계층(Data Link Layer) : 프레임 (frame)은 헤더에 목적지 MAC주소, 출발지 MAC 주소, 에러 검출을 위한 CRC 등의 정보가 포함되어 있다.
3. 네트워크 계층(Network Layer) : 패킷 (Packet)은 헤더에 목적지 IP 주소, 출발지 IP 주소, 라우팅을 위한 TTL(Time-to-Live : 폐기 잔여 시간)등의 정보가 포함되어 있다.
4. 전송 계층(Transport Layer) : 세그먼트 (Segment)는 헤더에 출발지 포트 번호, 목적지 포트 번호, 전송 제어 정보 (ex. TCP의 시퀀스 번호, 확인 응답 번호 등)등의 정보가 포함되어 있다.  
   **따라서 TCP의 경우, 헤더에 시퀀스 번호가 포함되어 수신자가 패킷을 올바르게 재정렬하고,
   UDP의 경우, 패킷 순서 지정에 대한 규정이 없으며 수신자는 패킷이 도착하면 처리한다.**
   > 패킷 통신은 데이터를 작은 단위로 나누어 전송하기 때문에, 순서가 뒤섞이거나 내용이 유실될 수 있다. 이러한 문제를 해결하기 위해 TCP 프로토콜이 존재한다. TCP 프로토콜은 패킷 전달 여부를 보증하고, 목적지에 도착한 패킷들을 순서대로 정렬하여 패킷을 송신 순서대로 받게 해준다. 
6. 세션 계층(Session Layer) : 데이터 (Data)
7. 표현 계층 (Presentation Layer) : 데이터 (Data)
8. 응용 계층 (Application Layer) : 메시지 (Message)


<br />


### ARP에 대해 설명해 주세요.
ARP(Address Resolution Protocol)은 2계층인 데이터 링크 계층에 위치한 프로토콜로, 주소 결정 프로토콜이라고 불린다.  
ARP는 네트워크 상에서 논리적 주소인 IP주소를 물리적 주소인 MAC 주소에 대응시켜 MAC 주소를 알아내는데 사용된다.  
IP 주소는 특정 PC의 네트워크까지만 접근할 수 있어서 **PC에 접근하기 위해서는 목적지인 PC의 MAC 주소를 알아내야 한다.**    
LAN 환경에서는 MAC 주소를 기반으로 통신하기 때문에 이더넷 환경에서의 통신을 위해서라면 MAC 주소를 알아야 한다.
 


<br />
<br />

---

<br />

데이터 전송 과정 : https://better-together.tistory.com/89  
예제를 통한 TCP/IP 흐름 이해 : https://wooono.tistory.com/507  
https://itwiki.kr/w/OSI_7%EA%B3%84%EC%B8%B5  
https://backendcode.tistory.com/167  
https://github.com/ssafy-tech-concert/ssafy-tech-concert/blob/master/Computer-Science/OSI%207%20layer.md  
https://velog.io/@hidaehyunlee/%EB%8D%B0%EC%9D%B4%ED%84%B0%EA%B0%80-%EC%A0%84%EB%8B%AC%EB%90%98%EB%8A%94-%EC%9B%90%EB%A6%AC-OSI-7%EA%B3%84%EC%B8%B5-%EB%AA%A8%EB%8D%B8%EA%B3%BC-TCPIP-%EB%AA%A8%EB%8D%B8#5-tcpip-%EB%AA%A8%EB%8D%B8  
IP 주소와 port : https://all-young.tistory.com/20  
ARP : https://all-young.tistory.com/126  
네트워크 : https://blog.naver.com/ye_won_01/223064063819  
L3 스위치, 라우터 간의 차이 : https://fiberroad.com/ko/resources/tech-notes/understanding-the-differences-between-layer-3-switches-and-routers/  
OSI 7계층: https://quartz-base-7c0.notion.site/OSI-7-026b6026b32847428b4a6d3ac88a31cd 
